# 티커 유니버스 확장 전략

## 개요

미국 주식 티커 유니버스를 S&P 500/400/600 + Russell 2000 (~2,800개)에서 **전체 미국 시장 (~6,000-8,000개)**으로 확장하는 전략입니다.

---

## 현재 상태

| 인덱스 | 소스 | 종목 수 | 특징 |
|--------|------|---------|------|
| S&P 500 | Wikipedia | ~500 | 대형주, 흑자 기업만 |
| S&P 400 | Wikipedia | ~400 | 중형주 |
| S&P 600 | Wikipedia | ~600 | 소형주 |
| Russell 2000 | iShares IWM | ~2,000 | 소형주 |
| **합계** | | **~2,800** | 중복 제거 후 |

### 누락되는 종목 유형

현재 유니버스에서 누락되는 종목들:

| 유형 | 예시 | 누락 이유 |
|------|------|----------|
| 적자 대형 기술주 | MDB, SNOW, PLTR | S&P 500 GAAP 흑자 요건 미충족 |
| 신규 상장 대형주 | 최근 IPO 기업 | 인덱스 편입 대기 중 |
| ADR/외국 기업 | 미국 상장 해외 기업 | Russell 제외 대상 |

---

## 확장 전략: 전체 미국 시장 수집

### 목표

- NYSE + NASDAQ 전체 상장 종목 수집
- 약 6,000-8,000개 종목
- 어떤 미국 주식이든 검색 가능

### 데이터 소스

**NASDAQ FTP** (권장)

| 항목 | 내용 |
|------|------|
| URL | ftp://ftp.nasdaqtrader.com/symboldirectory/ |
| 파일 | `nasdaqlisted.txt`, `otherlisted.txt` |
| 장점 | 공식 데이터, 무료, 매일 업데이트 |
| 형식 | `|` 구분자 텍스트 파일 |

### 예상 영향

| 항목 | 현재 | 변경 후 |
|------|------|---------|
| 종목 수 | ~2,800 | ~6,000-8,000 |
| 수집 시간 | ~15분 | ~1-2시간 |
| Supabase 용량 | ~60MB | ~150MB (무료 500MB 내) |

---

## CLI 옵션

| 옵션 | 동작 |
|------|------|
| (기본) | 전체 시장 수집 |
| `--sp500` | S&P 500만 (기존) |
| `--index-only` | S&P 500/400/600 + Russell 2000 (기존 동작) |

---

## 품질 관리

### 수집 시

- 유니버스 커버리지 검사
- 대형주 누락 검사 (시가총액 Top 15)
- 지표 완성도 검사

### UI 제공

- 시가총액/거래량 필터 옵션
- 페니스톡 경고 표시

---

## 구현 파일

### 코드

| 파일 | 변경 내용 |
|------|----------|
| `collectors/us_stocks.py` | `get_all_us_tickers()` 재작성, NASDAQ FTP 사용 |
| `processors/quality_check.py` | `US_MAJOR_TICKERS` 재정의 |

### 문서

| 파일 | 변경 내용 |
|------|----------|
| `CLAUDE.md` | 유니버스 설명 + 종목 수 |
| `.claude/rules/architecture.md` | 티커 소스, 수집 시간 |
| `.claude/rules/commands.md` | 명령어 설명, 시간 |

---

## 대안 옵션 (참고)

### 옵션 1: NASDAQ-100 추가만

- 종목 수: +50 (중복 제외)
- 포함: MDB, MELI, TEAM, ZS 등
- 장점: 빠른 구현, 최소 영향

### 옵션 2: Russell 1000 추가

- 종목 수: +200 (중복 제외)
- 포함: 대형/중형주 전체
- 소스: iShares IWB ETF

### 옵션 3: 수동 티커 추가

- 방식: `data/custom_tickers.txt` 파일로 관리
- 장점: 필요한 종목만 추가, 유연함
- 단점: 수동 관리 필요

---

## 관련 문서

- 아키텍처: `.claude/rules/architecture.md`
- 명령어: `.claude/rules/commands.md`
- 데이터 정책: `.claude/rules/data-policy.md`
